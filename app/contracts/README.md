# Generated Contract SDKs

This directory contains TypeScript SDKs generated by CPM (Contract Package Manager) for NEO smart contracts.

## ğŸ“ Directory Structure

```
contracts/
â””â”€â”€ neotoken/           # NEO Token contract SDK
    â”œâ”€â”€ index.ts        # Main exports
    â”œâ”€â”€ NeoToken.ts     # Contract class with methods
    â””â”€â”€ api.ts          # Low-level invocation helpers
```

## ğŸš€ Usage

### Import the SDK

```typescript
import { NeoToken } from '~/contracts/neotoken';
```

### Create Contract Instance

```typescript
import { NeonInvoker } from '@cityofzion/neon-dappkit';

const invoker = await NeonInvoker.init({
  rpcAddress: NeonInvoker.TESTNET,
});

const neo = new NeoToken({
  scriptHash: NeoToken.SCRIPT_HASH, // Built-in constant
  invoker: invoker,
});
```

### Call Contract Methods

```typescript
// Read methods (no wallet needed)
const symbol = await neo.symbol();              // "NEO"
const decimals = await neo.decimals();          // 0
const supply = await neo.totalSupply();         // 100000000
const balance = await neo.balanceOf({ 
  account: 'NbnjKGMBJzJ6j5PHeYhjJDaQ5Vy5UYu4Fv' 
});

// Write methods (wallet needed)
const txId = await neo.transfer({
  from: myAddress,
  to: recipientAddress,
  amount: 100000000,
  data: null,
});
```

## ğŸ”„ Regenerating SDKs

When a contract is updated on the blockchain:

```bash
# Download latest manifest
cpm download manifest -c 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 -N https://testnet1.neo.coz.io:443

# Regenerate SDK
cpm generate ts -m contract.manifest.json -c 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 -o app/contracts

# Cleanup
rm contract.manifest.json
```

## âš™ï¸ Configuration

SDKs are generated based on `cpm.yaml` in the project root:

```yaml
defaults:
  off-chain:
    languages:
      - ts
    destinations:
      ts: app/contracts  # This directory
```

## ğŸ“š Available Contracts

### NEO Token (TestNet)
- **Script Hash**: `0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5`
- **Network**: NEO TestNet
- **Class**: `NeoToken`
- **Methods**: See [NeoToken.ts](./neotoken/NeoToken.ts)

## ğŸ”§ Adding New Contracts

1. Add to `cpm.yaml`:
```yaml
contracts:
  - label: My Contract
    script-hash: 0x1234567890abcdef...
    source-network: testnet
    generate-sdk: true
```

2. Generate SDK:
```bash
cpm run
```

3. Import in your app:
```typescript
import { MyContract } from '~/contracts/mycontract';
```

## âš ï¸ Important Notes

### CommonJS Compatibility
The generated SDKs have been modified to work with Vite:

```typescript
// Type-only imports use 'import type'
import type { Neo3Parser } from "@cityofzion/neon-dappkit-types"

// Runtime imports use the main package
import { TypeChecker } from "@cityofzion/neon-dappkit"
```

### Do Not Edit Manually
These files are generated by CPM. Manual changes will be overwritten when regenerating.

If you need custom functionality:
1. Create wrapper functions in your app code
2. Extend the generated classes in separate files
3. Use the `api.ts` functions directly for custom invocations

## ğŸ“– Documentation

- [Full Implementation Guide](../../docs/neo-walletconnect-implementation.md)
- [Quick Start](../../docs/quick-start.md)
- [CPM Documentation](https://github.com/CityOfZion/cpm)
- [Neon DappKit](https://github.com/CityOfZion/neon-dappkit)

## ğŸ› Troubleshooting

### Import Errors
If you see "Named export not found" errors, ensure the SDK files use `import type` for type-only imports.

### Type Errors
Run TypeScript compiler to check for issues:
```bash
pnpm typecheck
```

### Contract Call Failures
1. Check network (TestNet vs MainNet)
2. Verify contract hash is correct
3. Ensure invoker is properly initialized
4. Check method parameters match contract expectations

